Name:           grilo
Version:        @VERSION@
Release:        1
Summary:        Grilo framework

Group:          Applications/Multimedia
License:        LGPLv2+
Source0:        grilo-%{version}.tar.gz
BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)

BuildRequires:  gnome-common
BuildRequires:  vala-devel >= 0.7.2
BuildRequires:  vala-tools >= 0.7.2
BuildRequires:  gtk-doc
BuildRequires:  gobject-introspection-devel
BuildRequires:  libxml2-devel
BuildRequires:  libsoup-devel
#Requires:

%description
Grilo is a framework that provides access to different sources of
multimedia content, using a pluggable system.
This package contains the core library and elements.

%package devel
Summary:        Libraries/include files for Grilo framework
Group:          Development/Libraries

Requires:       %{name} = %{version}-%{release}
Requires:       glib2-devel

%description devel
Grilo is a framework that provides access to different sources of
multimedia content, using a pluggable system.
This package contains the core library and elements, as well as
general and API documentation.

%package vala
Summary:        Vala language bindings for Grilo framework
Group:          Development/Other

Requires:       %{name} = %{version}-%{release}
Requires:       vala >= 0.7.2

%description vala
Grilo is a framework that provides access to different sources of
multimedia content, using a pluggable system.
This package contains the Vala language bindings.

%prep
%setup -q


%build
%configure                      \
	--enable-vala	        \
	--enable-gtk-doc        \
        --enable-introspection  \
        --disable-tests

make %{?_smp_mflags}


%install
rm -rf $RPM_BUILD_ROOT
make install DESTDIR=$RPM_BUILD_ROOT

# Remove files that will not be packaged
rm -f $RPM_BUILD_ROOT%{_libdir}/*.la
rm -f $RPM_BUILD_ROOT%{_libdir}/*.a
rm -f $RPM_BUILD_ROOT%{_bindir}/grilo-simple-playlist

%clean
rm -rf $RPM_BUILD_ROOT


%files
%defattr(-,root,root,-)
%doc AUTHORS COPYING NEWS README TODO
%{_libdir}/*.so.*
%{_libdir}/girepository-1.0/*.typelib
%{_bindir}/grl-inspect

%files devel
%defattr(-,root,root,-)
%doc AUTHORS COPYING NEWS README TODO
%{_includedir}/%{name}-@GRL_MAJORMINOR@/*.h
%{_includedir}/%{name}-@GRL_MAJORMINOR@/net/*.h
%{_libdir}/*.so
%{_libdir}/pkgconfig/*.pc
%{_datadir}/gir-1.0/*.gir
%doc %{_datadir}/gtk-doc/html/%{name}/*
%doc %{_datadir}/gtk-doc/html/%{name}-libs/*

%files vala
%defattr(-,root,root,-)
%doc AUTHORS COPYING NEWS README TODO
%{_datadir}/vala-0.10/vapi/*

%changelog
* Thu Jan 27 2011 Juan A. Suarez Romero <jasuarez@igalia.com> - 0.1.8-1
- Several fixes
- Improved documentation
- Reworked GrlConfig
- Added new types and functions in GrlConfig
- Added padded for public structures
- Added sync version of grl_media_source_get_media_from_uri()

* Fri Jan 21 2011 Juan A. Suarez Romero <jasuarez@igalia.com> - 0.1.7-1
- Several fixes, including fixes for bgs #627864, #628506, #629369, #630493, #635394
- Added Grilo Net Web Client (GrlNetWc)
- Implemented grl_multiple_get_media_from_size(): build a GrlMedia from given a site url
- Implemented grl_plugin_registry_add_config_from_file(): locad plugin configuration from a file
- Added a GError parameter to GrlPluginRegistry functions tat can fail
- Added new GrlCoreError
- Log system revamp
- Improved documentation
- Improved gobject introspection annotations
- Improved Vala bindings
- Using functions instead of definitions in grl-media-plugin
- Updated tests infrastructure
- Added new python tests using gobject introspection

* Thu Aug 26 2010 Juan A. Suarez Romero <jasuarez@igalia.com> - 0.1.6-1
- Several fixes, including fixes for GB#620143, GB#62047 and GB#627207
- Use SILENCE mode when building
- Added (un)serialization API to GrlMedia
- New metadata key system based on GParamSpec
- Added API to get all available keys
- Added API to initialize Grilo
- Added API to search in several plugins at the same time
- Added API with utility functions
- Added command-line options
- Use XML to define plugins
- Added new keys: external-url, external-player, studio, certificate and license
- grl_media_source_metadata() is cancelable
- Handle flickr authorization in test-ui
- Added synchronous functions for the asynchronous partners
- Added grl-inspect utility
- Renamed grl_plugin_registry_get_instance() to grl_plugin_registry_get_default().
- Improved Vala bindings
- Improved GObject Introspction support

* Fri May 07 2010 Juan A. Suarez Romero <jasuarez@igalia.com> - 0.1.5-1
- General fixes
- Added initial support for testing
- Added new documentation: overview, quick start, examples, ...
- Updated Vala bindings
- Changed GrlConfig: now keys are strings instead of GrlKeyID
- Improved build system
- Added Vimeo plugin in Test UI

* Fri Mar 12 2010 Juan A. Suarez Romero <jasuarez@igalia.com> - 0.1.4-1
- Improved code and documentation
- New API to configure plugins and sources
- New API to modify content in sources
- New keys: play-count, last-played, last-position
- Introspection support in build system
- Refactored content classes
- Renamed sources_by_capabilities() to sources_by_operations()

* Mon Mar 01 2010 Juan A. Suarez Romero <jasuarez@igalia.com> - 0.1.3-1
- Added ranks to plugins
- Added functions to search sources by capabilities
- Gtk-doc for GrlMediaPlugin and GrlMetadataSource

* Fri Feb 19 2010 Juan A. suarez Romero <jasuarez@igalia.com> - 0.1.2-1
- Improved Vala bindings
- Fixed some bugs
- Started initial support for gtk-doc

* Tue Feb 16 2010 Juan A. Suarez Romero <jasuarez@igalia.com> - 0.1.1-1
- Initial release
